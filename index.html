<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CSC Hub ‚Äî Professional Store & Blog</title>
    <meta name="author" content="Priyanko Manna" />
    <meta name="description" content="CSC Digital Services, Shop & Blog" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Rajdhani:wght@400;600&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root{
          --neon-cyan: #00ffe7;
          --neon-mag: #ff00f7;
          --card-bg: rgba(255,255,255,0.03);
        }
        body{
          font-family: 'Rajdhani', sans-serif;
          background: radial-gradient(circle at 10% 10%, #071026 0%, #081827 20%, #071a2b 45%, #081a29 100%);
          color: #e6f7ff;
          -webkit-font-smoothing:antialiased;
        }
        header{ font-family:'Orbitron',sans-serif; }
        .glow-card{
          background: var(--card-bg);
          border: 1px solid rgba(0,255,235,0.08);
          backdrop-filter: blur(6px);
          transition: transform .25s, box-shadow .25s;
        }
        .glow-card:hover{ transform: translateY(-6px); box-shadow: 0 12px 30px rgba(0,255,235,0.06); }
        .glow-btn{
          background: linear-gradient(135deg,var(--neon-cyan),#0077ff);
          color:#021020; padding:.6rem 1.1rem; border-radius:9999px; font-weight:700;
        }
        .glow-btn:hover{ box-shadow: 0 8px 34px rgba(0,255,235,0.12); transform: translateY(-2px); }
        .reader-backdrop{ background: linear-gradient(180deg, rgba(3,6,12,0.6), rgba(1,4,7,0.85)); }
        .post-body h1{ font-family:'Orbitron'; font-size:1.5rem; color:var(--neon-cyan); }
        .post-body h2{ font-family:'Orbitron'; color:#9be7ff; }
        .post-body a{ color: #ffd1ff; text-decoration: underline; }
        .post-body code{ background: rgba(255,255,255,0.03); padding: 2px 6px; border-radius:6px; color:#f0f0f0; }
        .nebula {
          position: fixed; inset:0; z-index:-1; pointer-events:none;
          background-image:
            radial-gradient(circle at 20% 10%, rgba(255,0,200,0.06) 0 8%, transparent 20%),
            radial-gradient(circle at 80% 80%, rgba(0,200,255,0.04) 0 12%, transparent 30%),
            radial-gradient(circle at 50% 40%, rgba(100,80,255,0.03) 0 6%, transparent 16%);
          mix-blend-mode: screen;
          filter: blur(30px) saturate(120%);
          opacity: 0.9;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

<div class="nebula"></div>

<!-- Header -->
<header class="text-center py-8 px-4">
    <h1 class="text-4xl font-bold tracking-wider text-cyan-200">CSC Hub</h1>
    <p class="text-gray-300 text-lg mt-1">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏, ‡¶™‡¶£‡ßç‡¶Ø ‡¶ì ‡¶¨‡ßç‡¶≤‡¶ó ‚Äî ‡¶∏‡¶¨ ‡¶è‡¶ï ‡¶ú‡¶æ‡¶Ø‡¶º‡¶ó‡¶æ‡¶Ø‡¶º</p>
    <div class="mt-5 flex justify-center gap-4">
        <a href="#shop" class="glow-btn">üõí ‡¶¶‡ßã‡¶ï‡¶æ‡¶®</a>
        <a href="#blog" class="glow-btn">üìù ‡¶¨‡ßç‡¶≤‡¶ó</a>
    </div>
</header>

<!-- Services -->
<section id="services" class="p-6 max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="glow-card p-5 rounded-2xl">
        <h2 class="text-xl text-cyan-300">Aadhaar</h2>
        <p class="text-sm text-gray-300">Enrollment & Update</p>
    </div>
    <div class="glow-card p-5 rounded-2xl">
        <h2 class="text-xl text-cyan-300">PAN</h2>
        <p class="text-sm text-gray-300">Card Application</p>
    </div>
    <div class="glow-card p-5 rounded-2xl">
        <h2 class="text-xl text-cyan-300">Recharge</h2>
        <p class="text-sm text-gray-300">Mobile & DTH</p>
    </div>
</section>

<!-- Shop -->
<section id="shop" class="p-6 max-w-6xl mx-auto mt-4">
    <h2 class="text-2xl mb-4 text-purple-300">üõçÔ∏è Shop Products</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="glow-card p-4 rounded-2xl">
            <h3 class="text-lg">Aadhaar Form Bundle</h3>
            <p class="text-sm text-gray-300">Printed Aadhaar forms + guidance</p>
            <div class="mt-3 flex items-center justify-between">
                <div class="text-cyan-200 font-bold">‚Çπ49</div>
                <button class="glow-btn">Add</button>
            </div>
        </div>
        <div class="glow-card p-4 rounded-2xl">
            <h3 class="text-lg">PAN Application Kit</h3>
            <p class="text-sm text-gray-300">PAN form + scanning service</p>
            <div class="mt-3 flex items-center justify-between">
                <div class="text-cyan-200 font-bold">‚Çπ99</div>
                <button class="glow-btn">Add</button>
            </div>
        </div>
        <div class="glow-card p-4 rounded-2xl">
            <h3 class="text-lg">Xerox Pack (50 pages)</h3>
            <p class="text-sm text-gray-300">High quality mono xerox</p>
            <div class="mt-3 flex items-center justify-between">
                <div class="text-cyan-200 font-bold">‚Çπ120</div>
                <button class="glow-btn">Add</button>
            </div>
        </div>
    </div>
</section>

<!-- Blog -->
<section id="blog" class="p-6 max-w-6xl mx-auto mt-8">
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl text-green-300">üì° Latest Blog Posts</h2>
        <div class="flex gap-3 items-center">
            <input id="search" class="px-3 py-2 rounded-lg bg-transparent border border-cyan-700 text-sm text-gray-200" placeholder="Search posts..." />
            <select id="sort" class="px-3 py-2 rounded-lg bg-transparent border border-cyan-700 text-sm text-gray-200">
                <option value="new">Newest first</option>
                <option value="old">Oldest first</option>
            </select>
        </div>
    </div>

    <div id="postsList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
</section>

<!-- Reader Modal -->
<div id="reader" class="fixed inset-0 z-50 hidden items-center justify-center p-6">
    <div class="absolute inset-0 reader-backdrop opacity-95" onclick="closeReader()"></div>
    <div class="relative max-w-3xl w-full bg-gradient-to-b from-[#04121b] to-[#03131b] rounded-2xl p-6 glow-card text-gray-100 overflow-auto" style="max-height:90vh;">
        <div class="flex items-start justify-between gap-4">
            <div>
                <h3 id="readerTitle" class="text-2xl font-bold"></h3>
                <div id="readerDate" class="text-sm text-gray-400 mt-1"></div>
            </div>
            <div class="ml-auto flex gap-2">
                <button class="px-3 py-2 rounded-lg border border-cyan-700 text-sm" onclick="toggleTheme()">Theme</button>
                <button class="px-3 py-2 rounded-lg border border-cyan-700 text-sm" onclick="closeReader()">Close</button>
            </div>
        </div>
        <hr class="my-4 border-cyan-800" />
        <article id="readerBody" class="post-body prose prose-invert max-w-none"></article>
    </div>
</div>

<!-- Contact -->
<footer class="mt-12 p-6 text-center border-t border-cyan-700">
    <p>üìß <a href="mailto:mtpl.kolaghat@gmail.com" class="text-cyan-200">mtpl.kolaghat@gmail.com</a> | üìû <a href="tel:+918967744210" class="text-cyan-200">+91-8967744210</a></p>
    <p>üìç Kolaghat, West Bengal 721154</p>
    <p class="text-gray-500 mt-2">¬© 2025 CSC Hub ‚Äî Powered by ‡¶ñ‡ßã‡¶≤‡¶æ‡¶™‡¶æ‡¶§‡¶æ</p>
</footer>

<!-- Script: posts loader + permalink + md parser -->
<script>
    /***** Compatibility: If you already include a posts array elsewhere,
           expose it as window.sitePosts BEFORE this HTML loads.
           This script will use window.sitePosts || window.posts || fallback.
    *****/

    // Default posts fallback ‚Äî used only if you don't provide sitePosts/posts externally
    const _defaultPosts = [
      { file: "posts/demo.md", title: "Welcome Post", date: "2025-09-13" }
    ];

    // Resolve posts array (preference order)
    const POSTS = (function(){
      if (Array.isArray(window.sitePosts)) return window.sitePosts;
      if (Array.isArray(window.posts)) return window.posts;
      return _defaultPosts;
    })();

    // Utility: fetch markdown, return text (handles 404 gracefully)
    async function fetchMarkdown(path){
      try{
        const res = await fetch(path, {cache: "no-store"});
        if(!res.ok) return `# Error\nCould not load ${path} (status ${res.status})`;
        return await res.text();
      } catch(err){
        return `# Error\nNetwork error loading ${path}\n\n${err.message}`;
      }
    }

    // Tiny Markdown -> HTML converter (safe-ish, not full CommonMark)
    function mdToHtml(md){
      md = md.replace(/\r\n/g,"\n");
      md = md.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
      md = md.replace(/```([a-zA-Z0-9_-]*)\n([\s\S]*?)```/g, (m,lang,code) => {
        return `<pre><code class="language-${lang}">${code.replace(/</g,"&lt;")}</code></pre>`;
      });
      md = md.replace(/^###### (.*$)/gim, '<h6>$1</h6>');
      md = md.replace(/^##### (.*$)/gim, '<h5>$1</h5>');
      md = md.replace(/^#### (.*$)/gim, '<h4>$1</h4>');
      md = md.replace(/^### (.*$)/gim, '<h3>$1</h3>');
      md = md.replace(/^## (.*$)/gim, '<h2>$1</h2>');
      md = md.replace(/^# (.*$)/gim, '<h1>$1</h1>');
      md = md.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      md = md.replace(/\*(.+?)\*/g, '<em>$1</em>');
      md = md.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');
      md = md.replace(/^\s*[-*] (.+)/gim, '<li>$1</li>');
      md = md.replace(/(<li>[\s\S]*?<\/li>)/g, (m) => `<ul>${m.replace(/<\/li>\s*<li>/g,"</li><li>")}</ul>`);
      const blocks = md.split(/\n{2,}/).map(block => {
        if(/^\s*<(h\d|ul|pre|blockquote)/.test(block) || /^<h\d>/.test(block)) return block;
        if(/^\s*<li>/.test(block)) return block;
        return '<p>' + block.replace(/\n/g, '<br/>') + '</p>';
      });
      return blocks.join("\n");
    }

    function fmtDate(d){
      try{
        const dt = new Date(d + "T00:00:00");
        return dt.toLocaleDateString('bn-IN', { year:'numeric', month:'short', day:'numeric' });
      }catch(e){ return d; }
    }

    // Render posts list and wire interactions
    async function renderPosts(){
      const container = document.getElementById('postsList');
      container.innerHTML = '<div class="col-span-full text-gray-400">Loading posts...</div>';

      // Preload markdown for every post
      const enhanced = await Promise.all(POSTS.map(async p => {
        const raw = await fetchMarkdown(p.file);
        return { ...p, raw };
      }));

      // expose for debugging
      window.__postsCache = enhanced;

      const searchInput = document.getElementById('search');
      const sortSelect = document.getElementById('sort');

      function update(){
        const q = searchInput.value.trim().toLowerCase();
        const sort = sortSelect.value;
        let list = enhanced.slice();
        if(q) list = list.filter(item => (item.title + " " + item.raw).toLowerCase().includes(q));
        list.sort((a,b)=> sort==='new' ? new Date(b.date)-new Date(a.date) : new Date(a.date)-new Date(b.date));
        if(list.length===0){
          container.innerHTML = '<div class="text-gray-400">No posts found.</div>';
          return;
        }
        container.innerHTML = '';
        list.forEach(item => {
          const excerpt = item.raw.replace(/\n/g,' ').slice(0,220).replace(/#/g,'');
          const card = document.createElement('div');
          card.className = 'glow-card p-4 rounded-2xl cursor-pointer';
          card.innerHTML = `
            <div class="flex items-start justify-between gap-3">
              <div>
                <h3 class="text-lg font-semibold text-cyan-100">${escapeHtml(item.title)}</h3>
                <div class="text-sm text-gray-400 mt-1">${fmtDate(item.date)}</div>
                <p class="text-sm text-gray-300 mt-3">${escapeHtml(excerpt)}...</p>
              </div>
              <div class="flex flex-col items-end gap-2">
                <button class="glow-btn" data-file="${escapeHtml(item.file)}">Read</button>
              </div>
            </div>
          `;
          card.querySelector('button').addEventListener('click', (ev)=>{
            ev.stopPropagation();
            openReader(item, true);
          });
          card.addEventListener('click', ()=> openReader(item, true));
          container.appendChild(card);
        });
      }

      searchInput.addEventListener('input', update);
      sortSelect.addEventListener('change', update);
      update();

      // After render, if URL has post param open it
      const urlPost = getUrlPostParam();
      if(urlPost){
        const found = enhanced.find(p => encodeURIComponent(p.file) === urlPost || encodeURIComponent(p.title) === urlPost);
        if(found) openReader(found, false, true);
      }
    }

    function escapeHtml(str){
      return String(str).replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }

    // Permalink helpers
    function setUrlPostParam(encoded, replace=false){
      const url = new URL(window.location.href);
      if(encoded){
        url.searchParams.set('post', encoded);
      } else {
        url.searchParams.delete('post');
      }
      if(replace) history.replaceState({post: encoded}, '', url);
      else history.pushState({post: encoded}, '', url);
    }
    function getUrlPostParam(){
      try{
        const url = new URL(window.location.href);
        const p = url.searchParams.get('post');
        return p ? p : null;
      }catch(e){ return null; }
    }

    // Open reader. If pushUrl true, push URL; if replaceOnly true, replace instead of pushing
    function openReader(item, pushUrl=true, replaceOnly=false){
      const reader = document.getElementById('reader');
      document.getElementById('readerTitle').textContent = item.title;
      document.getElementById('readerDate').textContent = fmtDate(item.date);
      const html = mdToHtml(item.raw);
      document.getElementById('readerBody').innerHTML = html;
      reader.classList.remove('hidden'); reader.style.display='flex';
      document.body.style.overflow = 'hidden';

      // set permalink param as encoded file (safe)
      const encoded = encodeURIComponent(item.file);
      if(pushUrl){
        setUrlPostParam(encoded, replaceOnly);
      } else {
        // don't push, but ensure current URL shows post (replace state) so refresh keeps it
        setUrlPostParam(encoded, true);
      }
    }

    function closeReader(pushUrl=true){
      const reader = document.getElementById('reader');
      reader.classList.add('hidden'); reader.style.display='none';
      document.body.style.overflow = '';
      if(pushUrl){
        // remove post param and push state
        setUrlPostParam('', false);
      } else {
        setUrlPostParam('', true);
      }
    }

    // Respond to browser navigation (back/forward)
    window.addEventListener('popstate', (ev) => {
      const p = getUrlPostParam();
      if(p){
        // find loaded cached post with matching encoded file or title
        const cached = window.__postsCache || [];
        const found = cached.find(x => encodeURIComponent(x.file) === p || encodeURIComponent(x.title) === p);
        if(found){
          openReader(found, false, true);
          return;
        }
        // if not found, try to fetch raw file path decoded
        try {
          const decoded = decodeURIComponent(p);
          const match = cached.find(x => x.file === decoded);
          if(match) openReader(match, false, true);
        } catch(e){}
      } else {
        // no post param -> close reader if open
        const reader = document.getElementById('reader');
        if(!reader.classList.contains('hidden')) closeReader(false);
      }
    });

    // small theme placeholder
    function toggleTheme(){
      alert('Theme toggle placeholder ‚Äî replace with your light/dark CSS logic if needed.');
    }

    // Init
    document.addEventListener('DOMContentLoaded', ()=> {
      renderPosts();
      // close reader on Escape
      document.addEventListener('keydown', (e)=> { if(e.key==='Escape') closeReader(); });
    });

</script>
</body>
</html>
