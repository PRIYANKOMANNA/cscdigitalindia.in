<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title id="page-title">Post</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
<nav class="navbar navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="index.html">← Back to Home</a>
    </div>
</nav>

<main class="container py-4">
    <article id="post-article" class="mx-auto" style="max-width:900px;">
        <h1 id="post-title"></h1>
        <div id="post-content" class="mt-3"></div>
    </article>
</main>

<footer class="py-4 text-center bg-dark text-white">
    © <span id="year2"></span> CSC Hub
</footer>

<script>
    document.getElementById('year2').textContent = new Date().getFullYear();

    // Utility: get query param
    function getQueryParam(name) {
      const url = new URL(location.href);
      return url.searchParams.get(name);
    }

    const file = getQueryParam('file');
    const title = getQueryParam('title') ? decodeURIComponent(getQueryParam('title')) : '';

    if (!file) {
      document.getElementById('post-content').innerHTML = '<p class="text-danger">No post specified.</p>';
      document.title = 'Post not found';
    } else {
      document.getElementById('post-title').textContent = title || file;
      document.title = title || file;

      fetch('posts/' + file)
        .then(r => {
          if (!r.ok) throw new Error('Post not found');
          return r.text();
        })
        .then(md => {
          document.getElementById('post-content').innerHTML = marked.parse(md);
        })
        .catch(err => {
          document.getElementById('post-content').innerHTML = '<p class="text-danger">Error loading post.</p>';
          console.error(err);
        });
    }
</script>
</body>
</html>
